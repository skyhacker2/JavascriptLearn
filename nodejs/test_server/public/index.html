<html>
<head>
	<title>client</title>
</head>
<body>
	<p>Hello Client</p>
	<p>msg:<span class="msg"></span></p>
	<script src="/socket.io/socket.io.js"></script>
	<script src="js/jquery.js"></script>
	<script>
		function count() {
			var i = 0;
			var start = new Date();
			return function () {
				var end = new Date();
				var spend = end - start;
				i++;
				return {finished: i, time: spend};
			}
		}
		var socket = io.connect('http://192.168.10.107:8080');
		socket.on('news', function (data) {
			socket.emit('client',{});
		});
		socket.on('start the job', function (data) {
			//console.log(data);
			var counter = count();
			var num = parseInt(data.data.num);
			var url = data.data.url;
			//console.log(num);
			for (var i = 0; i < num; i++) {
				console.log('hhh');
				$.get('http://192.168.10.107/extract2', {
					url: url
				}, function(res) {
					var c = counter();
					$('.msg').html("finished: " + c.finished + " spend time: " + c.time);
					socket.emit('finish one', c);
				});
			}
		});

	</script>
</body>
</html>