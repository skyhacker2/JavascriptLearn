<!DOCTYPE html>
<html lang="%{{_lang_}}%">
<head>
<meta charset="utf-8" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>${{common.label.list}}$ - ${{common.appName}}$</title>
<!-- include "../inc/head.inc.html" -->
<script type="text/javascript">
document.write('<link rel="stylesheet" href="css/mod/customer/list-main.css" />');
</script>
</head>
<body>
<!-- include "../inc/body.inc.html" -->

<!-- require "../../js/lang/%{{_lang_}}%/customer" -->
<!-- require "../../js/mod/customer/list" -->
<script type="text/javascript">
;(function() {
	var langResourceCommon = require('../../lang/' + G.LANG + '/common');
	var params = G.getAjaxHistoryParams();
	var listId = params[0];

	G.pageRequire(['../../js/mod/customer/list', '../../js/mod/nav-bar/init', 'ajax!' + G.getAjaxLoadUrl('users/information'), 'ajax!' + G.getAjaxLoadUrl(listId ? 'lists/' + listId + '/overview' : 'lists')], function(main, navBar, auth, res) {
		require(['rfl'], function(rfl) {
			rfl.auth.init(auth, function() {
				var listsLen;
				navBar.init('list');
				if(listId) {
					main.init(listId, res);
				} else if(!rfl.ajax.dealCommonCode(res.code)) {
					if(res.code === 0) {
						listsLen = res.data.lists.length;
						if(listsLen === 1) {
							listId = res.data.lists[0].id;
							require(['ajax!' + G.getAjaxLoadUrl('lists/' + listId + '/overview')], function(res) {
								main.init(listId, res);
							});
						} else {
							rfl.util.replaceUrl('customer/list-list');
						}
					} else if(res.code === 2) {
						rfl.ui.renderInvalidUrl('#main-div');
					} else {
						rfl.ui.renderPageLoadError('#main-div');
					}
				}
			});
		});
	}, function() {
		require(['rfl'], function(rfl) {
			rfl.ui.renderPageLoadError('#main-div');
		});
	});
})();
</script>
</body>
</html>